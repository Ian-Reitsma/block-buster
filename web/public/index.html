<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Block Buster</title>
    <link rel="stylesheet" href="css/tailwind.min.css?v=20260205">
    <link rel="stylesheet" href="dashboard.css?v=20260205">
    <script src="js/utils.js?v=20260205"></script>
</head>
<body class="font-display min-h-screen relative">
    <div class="atmospheric-glow"></div>
    <main class="page-content flex items-center justify-center min-h-screen">
        <div class="panel-blade p-6 max-w-md text-center space-y-2">
            <div class="text-xs uppercase tracking-widest text-gray-400">Block Buster</div>
            <div class="text-lg font-semibold">Routing to the right view…</div>
            <div class="text-xs text-gray-500" id="landing-hint">Checking governor gates.</div>
        </div>
    </main>
    <script>
        (async function decideLanding() {
            const hint = document.getElementById('landing-hint');
            const dash = 'dashboard.html';
            const network = 'network.html';
            const timeout = setTimeout(() => { window.location.href = dash; }, 3000);
            try {
                const { apiBase } = resolveApiConfig();
                hint.textContent = `Checking ${apiBase}/theblock/gates …`;
                const res = await fetch(`${apiBase}/theblock/gates`, { cache: 'no-store' });
                clearTimeout(timeout);
                if (res.ok) {
                    const gates = await res.json();
                    const open = Array.isArray(gates) && gates.length > 0 && gates.every(g => (g.state || '').toLowerCase() === 'trade');
                    hint.textContent = open ? 'Markets are live. Opening dashboard.' : 'Markets are gated. Opening network health.';
                    window.location.href = open ? dash : `${network}?gated=1`;
                    return;
                }
            } catch (_) {
                clearTimeout(timeout);
            }
            hint.textContent = 'Falling back to dashboard.';
            window.location.href = dash;
        })();
    </script>
</body>
</html>
