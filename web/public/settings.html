<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Settings · Block Buster</title>
    <link rel="stylesheet" href="css/tailwind.min.css?v=20260219">
    <link rel="stylesheet" href="dashboard.css?v=20260219">
    
    <!-- Core dependencies (blocking) -->
    <script src="runtime-config.js?v=20260219"></script>
    <script src="js/utils.js?v=20260219"></script>
    
    <!-- Shell and navigation (blocking for layout) -->
    <script src="js/shell.js?v=20260219"></script>
    <script src="js/nav.js?v=20260219"></script>
    <script src="js/walkthrough.js?v=20260219" defer></script>
    
    <!-- Page-specific modules (deferred, loaded by boot.js) -->
    <script src="js/boot.js?v=20260219" defer></script>
</head>
<body class="font-display min-h-screen relative">
    <a href="#main-content" class="sr-only">Skip to content</a>
    <main id="main-content" class="page-content space-y-5">
        <div class="section-header" id="breadcrumb">
            <div class="section-meta">
                <span class="text-xs text-gray-400">Configure</span>
                <span class="text-xs text-gray-500">/</span>
                <span class="text-xs">Settings</span>
                <span id="settings-stale" class="status-pill status-warn" aria-live="polite">STALE</span>
                <span id="settings-schema" class="micro-badge">schema —</span>
            </div>
            <div class="section-meta">
                <span id="settings-lag" class="micro-badge">lag —</span>
                <span id="settings-errors" class="micro-badge">errs —</span>
                <span id="settings-updated" class="chip" aria-live="polite">Waiting for data</span>
            </div>
        </div>

        <section class="panel-blade space-y-3" id="connection-card">
            <div class="panel-header">
                <div>
                    <div class="panel-title">API Connection</div>
                    <div class="panel-subtitle">Validate base URL (API token optional).</div>
                </div>
                <div class="panel-actions">
                    <span id="connection-pill" class="status-pill status-warn">UNVERIFIED</span>
                    <span id="connection-chip" class="micro-badge">/health —</span>
                </div>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                <label class="label">API Base
                    <input type="url" id="rpcEndpoint" aria-describedby="rpcHint rpcCount" class="form-control" placeholder="http://localhost:5000" maxlength="200">
                    <div class="flex items-center justify-between text-xs text-gray-500 mt-1">
                        <span id="rpcHint">Must start with http(s) and include host.</span>
                        <span id="rpcCount">0/200</span>
                    </div>
                </label>
                <label class="label">API Token (optional)
                    <input type="password" id="apiKey" aria-describedby="apiKeyHint apiKeyCount" class="form-control" placeholder="optional when auth is enforced" maxlength="128">
                    <div class="flex items-center justify-between text-xs text-gray-500 mt-1">
                        <span id="apiKeyHint">Only needed if your server enforces auth.</span>
                        <span id="apiKeyCount">0/128</span>
                    </div>
                </label>
            </div>
            <div class="flex items-center justify-between">
                <div class="text-xs text-gray-400">Trading still requires a funded wallet.</div>
                <button id="saveConnection" class="btn primary is-stale" disabled data-control="save">Save Connection</button>
            </div>
        </section>

        <section class="panel-blade space-y-3" id="preferences-card">
            <div class="panel-header">
                <div>
                    <div class="panel-title">Preferences</div>
                    <div class="panel-subtitle">Theme, time, animation, guide.</div>
                </div>
                <div class="panel-actions">
                    <span id="preferences-pill" class="status-pill status-info">PENDING</span>
                    <span id="preferences-chip" class="micro-badge">/state —</span>
                    <button id="preferences-retry" class="micro-badge">Retry</button>
                </div>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                <label class="label">Theme
                    <select id="theme" class="form-control">
                        <option value="seeker">Seeker</option>
                        <option value="dark">Dark</option>
                        <option value="light">Light</option>
                    </select>
                </label>
                <label class="label">Time Zone
                    <select id="timeZone" class="form-control"></select>
                </label>
            </div>
            <div class="flex items-center gap-4 flex-wrap">
                <label class="flex items-center gap-2 text-sm"><input type="checkbox" id="advancedToggle"> Advanced Mode</label>
                <label class="flex items-center gap-2 text-sm"><input type="checkbox" id="disableAnimation"> Disable Background Animation</label>
                <label class="flex items-center gap-2 text-sm"><input type="checkbox" id="forceTour"> Reopen Guide</label>
            </div>
            <div class="text-xs text-gray-400">Current Time: <span id="currentTime">--:--:--</span></div>
        </section>

        <section class="panel-blade space-y-3" id="trading-card">
            <div class="panel-header">
                <div>
                    <div class="panel-title">Trading Setup</div>
                    <div class="panel-subtitle">Modes, primary asset, and modules.</div>
                </div>
                <div class="panel-actions">
                    <span id="trading-pill" class="status-pill status-info">PENDING</span>
                    <span id="trading-chip" class="micro-badge">/assets —</span>
                    <button id="trading-retry" class="micro-badge">Retry</button>
                </div>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                <label class="label">Trading Mode
                    <select id="tradingMode" class="form-control">
                        <option value="live" selected>Live</option>
                    </select>
                </label>
                <label class="label">Primary Asset
                    <input id="primaryAsset" list="assetOptions" aria-describedby="assetHint assetCount" maxlength="12" class="form-control" />
                    <datalist id="assetOptions"></datalist>
                    <div class="flex items-center justify-between text-xs text-gray-500 mt-1">
                        <span id="assetHint">Must match supported asset symbol.</span>
                        <span id="assetCount">0/12</span>
                    </div>
                </label>
                <label class="label advanced hidden">Starting Capital (BLOCK)
                    <input type="number" id="startingCapital" class="form-control" min="0" step="0.01">
                </label>
            </div>
            <div class="advanced hidden grid grid-cols-1 md:grid-cols-3 gap-3">
                <label class="label">Date Range
                    <input type="text" id="btRange" class="form-control" placeholder="YYYY-MM-DD - YYYY-MM-DD">
                </label>
                <label class="flex items-center gap-2 text-sm"><input type="checkbox" id="enableSniper"> Listing Sniper</label>
                <label class="flex items-center gap-2 text-sm"><input type="checkbox" id="enableArbitrage"> Arbitrage Engine</label>
                <label class="flex items-center gap-2 text-sm"><input type="checkbox" id="enableMarketMaking"> Market Making</label>
            </div>
            <div class="advanced hidden">
                <h3 class="text-sm text-gray-400 mb-1">Module Status</h3>
                <div id="moduleStatus" class="text-sm">--</div>
            </div>
        </section>

        <section class="panel-blade space-y-3" id="wallet-card">
            <div class="panel-header">
                <div>
                    <div class="panel-title">Node Wallet</div>
                    <div class="panel-subtitle">Auto-create if missing, or import an existing address.</div>
                </div>
                <div class="panel-actions">
                    <span id="wallet-pill" class="status-pill status-info">CHECKING</span>
                    <span id="wallet-chip" class="micro-badge">/wallet/status —</span>
                </div>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                <div class="space-y-2">
                    <div class="text-xs text-gray-400">Detected wallet</div>
                    <div class="text-lg font-semibold" id="wallet-address">—</div>
                    <div class="text-xs text-gray-500" id="wallet-balance">Balance —</div>
                    <div class="flex gap-2 flex-wrap">
                        <button id="wallet-create" class="btn secondary" type="button">Create local wallet</button>
                        <button id="wallet-refresh" class="btn ghost" type="button">Refresh</button>
                        <button id="wallet-copy" class="btn ghost" type="button">Copy</button>
                        <button id="wallet-reveal" class="btn ghost" type="button">Reveal key</button>
                    </div>
                    <div class="text-xs text-gray-500" id="wallet-secret" aria-live="polite">Private key hidden</div>
                </div>
                <div class="space-y-2">
                    <label class="label">Import / Connect Wallet
                        <input type="text" id="wallet-import" class="form-control" placeholder="tb1..." maxlength="80" aria-describedby="walletImportHint">
                        <div class="flex items-center justify-between text-xs text-gray-500 mt-1">
                            <span id="walletImportHint">Paste address; persisted locally.</span>
                            <span id="walletImportCount">0/80</span>
                        </div>
                    </label>
                    <div class="flex gap-2 flex-wrap">
                        <button id="wallet-import-btn" class="btn primary" type="button">Save wallet</button>
                        <button id="wallet-fund" class="btn ghost" type="button">Funding guide</button>
                    </div>
                </div>
            </div>
        </section>

        <section class="panel-blade space-y-3" id="metrics-card">
            <div class="panel-header">
                <div>
                    <div class="panel-title">Metrics Scrape</div>
                    <div class="panel-subtitle">/metrics text scrape status.</div>
                </div>
                <div class="panel-actions">
                    <span id="metrics-chip" class="micro-badge">/metrics —</span>
                    <button id="metrics-retry" class="micro-badge">Test</button>
                </div>
            </div>
            <div class="text-sm text-gray-400">Prometheus parity check; requires auth if enabled.</div>
            <div class="text-xs text-gray-500" id="metrics-stamp">Waiting…</div>
        </section>

        <section class="panel-blade space-y-3 hidden" id="cache-card">
            <div class="panel-header">
                <div>
                    <div class="panel-title">Asset / Price Cache</div>
                    <div class="panel-subtitle">Invalidate cached asset/price feed.</div>
                </div>
                <div class="panel-actions">
                    <span id="cache-chip" class="micro-badge">/assets/invalidate —</span>
                    <button id="cache-refresh" class="btn ghost" disabled>Refresh Cache</button>
                </div>
            </div>
            <div class="text-sm text-gray-400">Available only if backend exposes the invalidate hook.</div>
            <div class="text-xs text-gray-500" id="cache-stamp">Unavailable</div>
        </section>

        <div id="error-drawer" class="panel-blade p-4 hidden" aria-live="polite">
            <div class="flex items-center justify-between mb-2">
                <h3 class="text-sm font-semibold text-gray-300">Recent Errors</h3>
                <div class="flex items-center gap-2">
                    <button id="settings-error-retry" class="micro-badge">Retry</button>
                    <button id="error-clear" class="micro-badge">Clear</button>
                </div>
            </div>
            <ul id="error-list" class="text-xs text-gray-400 space-y-1"></ul>
        </div>
    </main>
    <script src="js/utils.js?v=20260219"></script>
    <script src="js/settings.js?v=20260219"></script>
    <script src="js/nav.js?v=20260219"></script>
    <script src="js/walkthrough.js?v=20260219"></script>
    <script src="js/footer.js?v=20260219"></script>
</body>
</html>
